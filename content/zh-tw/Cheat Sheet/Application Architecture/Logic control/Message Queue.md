---
title: "訊息佇列"
date: 2023-07-01
weight: 4
---

### 概述:

Message Queue是一種常用於非同步處理邏輯的機制。當某個服務需要較長時間完成時，為了避免上游等待，可以將服務請求放入佇列中，按序等待執行。後方會有多個服務Consumer從佇列中取得服務請求並完成相應的處理。

一個典型的Message Queue架構包含三個主要元件：Message producer（產生服務請求的角色）、Message consumer（處理服務請求的角色）以及Message broker（負責訊息排序和呼叫consumer的角色）。

透過使用Message Queue，我們能夠實現1對多的通訊。Producer不需要知道後方有多少個consumer，只要有註冊相應事件的consumer都會接收到訊息。這樣的設計模式有效地解耦了producer和consumer之間的直接依賴關係，使系統更加靈活和擴展。

透過適當地應用Message Queue，我們能夠改善系統的可靠性和效能，特別適用於處理非同步處理需求的情境。

### 使用情境:

- 非同步事件驅動
- 非同步通信
- 日誌處理

### 優點:

- 避免前端等待: producer只要發出訊息請求後，即可完成動作。
- 低耦合: 可將一個大的服務拆成多個鬆散的小服務。且各個服務之間不需要直接通信，交由Broker轉交請求即可。
- 擴展性: 當等待中的請求較多時，可動態增加更多Consumer來處理服務請求。
- 平行處理: 如果有多個consumer註冊同一事件，可同步進行事件處理，而不須依序排隊執行。

### 缺點:

- 無法即時得知結果：由於訊息需等待broker轉發。所以producer若需等待結果，則需要追蹤此訊息處理的狀態。